% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_mvsampen.R
\name{compute_mvsampen}
\alias{compute_mvsampen}
\title{Compute Multivariate Sample Entropy per Participant}
\usage{
compute_mvsampen(
  data,
  r = 0.2,
  participant_col = "ID",
  series_col = "Series_ID",
  time_col = "time"
)
}
\arguments{
\item{data}{An \code{experdyn_statespace} object returned by \code{\link[=make_statespace]{make_statespace()}}.}

\item{r}{\verb{[numeric(1): 0.2]}\cr
Matching tolerance. Data are z-scored within each subseries before
matching, so \code{r} is on a standardised scale.}

\item{participant_col}{\verb{[character(1): "ID"]}\cr
Participant identifier column.}

\item{series_col}{\verb{[character(1): "Series_ID"]}\cr
Subseries identifier column.}

\item{time_col}{\verb{[character(1): "time"]}\cr
Optional time column used for ordering within subseries when present.}
}
\value{
An object of class \code{experdyn_mvsampen} with:\tabular{ll}{
   Element \tab Description \cr
   \code{participant_entropy} \tab One row per participant with aggregated entropy. \cr
   \code{series_entropy} \tab One row per participant-subseries entropy estimate. \cr
   \code{dimensions} \tab Statespace embedding dimensions used as input. \cr
   \code{r} \tab Matching tolerance used. \cr
   \code{variables} \tab Variables included in entropy estimation. \cr
}
}
\description{
Computes multivariate sample entropy (mvSampEn) from a pre-built
state-space embedding, separately for each participant.

\strong{Input must be an \code{experdyn_statespace} object} from \code{\link[=make_statespace]{make_statespace()}}.
The function does not perform any additional embedding — each row of the
state-space matrix is already a trajectory point that encodes the optimal
delay \code{τ} and dimension \code{d} chosen by \code{\link[=estimate_embedding_parameters]{estimate_embedding_parameters()}}
and applied by \code{\link[=make_statespace]{make_statespace()}}. SampEn is then computed directly on
this sequence of trajectory points:

\itemize{
\item \strong{B} = proportion of all point-pairs \eqn{(i \ne j)} whose
Chebyshev distance is \eqn{\le r} (same-neighbourhood).
\item \strong{A} = proportion of consecutive point-pairs where \emph{both} the
current and next state-space point are simultaneously within
\eqn{r} (trajectory-neighbourhood).
\item \eqn{\text{mvSampEn} = -\log(A / B)}.
}

For each participant, entropy is first computed within each subseries and
then aggregated (weighted by number of template pairs) to yield a single
participant-level estimate.
}
\seealso{
\itemize{
\item \code{\link[=make_statespace]{make_statespace()}} for building the state-space passed to this function.
\item \code{\link[=estimate_embedding_parameters]{estimate_embedding_parameters()}} to choose \code{delay} and \code{dimensions}.
\item \code{\link[=compute_rqa]{compute_rqa()}} for recurrence-based complexity measures.
}
}
