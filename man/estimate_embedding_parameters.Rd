% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_embedding_parameters.R
\name{estimate_embedding_parameters}
\alias{estimate_embedding_parameters}
\title{Estimate Optimal State-Space Embedding Parameters}
\usage{
estimate_embedding_parameters(
  data,
  max_delay = 10,
  max_dim = 10,
  ami_selection_method = "first.e.decay",
  fnn_threshold = 0.05,
  plot = TRUE
)
}
\arguments{
\item{data}{A data frame, or an object returned by \code{\link[=resample_timeseries]{resample_timeseries()}}.
All numeric columns other than \code{ID}, \code{Series_ID}, and \code{time} are treated
as variables to analyse.}

\item{max_delay}{\verb{[integer(1): 10]}\cr
Maximum delay considered for AMI-based delay estimation.}

\item{max_dim}{\verb{[integer(1): 10]}\cr
Maximum embedding dimension considered for false-nearest-neighbours
estimation.}

\item{ami_selection_method}{\verb{[character(1): "first.e.decay"]}\cr
Selection rule passed to \code{\link[nonlinearTseries:timeLag]{nonlinearTseries::timeLag()}}.}

\item{fnn_threshold}{\verb{[numeric(1): 0.05]}\cr
False-neighbour threshold passed to
\code{\link[nonlinearTseries:estimateEmbeddingDim]{nonlinearTseries::estimateEmbeddingDim()}}.}

\item{plot}{\verb{[logical(1): TRUE]}\cr
If \code{TRUE}, stores a ggplot summary of per-series delay and \code{m} estimates
in \verb{$plot}.}
}
\value{
An object of class \code{experdyn_embedding} â€” a named list with:\tabular{ll}{
   Element \tab Description \cr
   \code{recommended_delay} \tab Overall recommended delay (median across estimates). \cr
   \code{recommended_dim} \tab Overall recommended embedding dimension (max across variable medians). \cr
   \code{variable_summary} \tab Per-variable summary table (central tendency + variability). \cr
   \code{series_estimates} \tab Per-series/per-variable raw estimates. \cr
   \code{overall_variability} \tab Overall variability metrics for delay and \code{m}. \cr
   \code{n_variables} \tab Number of analysed variables. \cr
   \code{n_series} \tab Number of analysed series/subseries. \cr
   \code{plot} \tab A \code{ggplot} object (or \code{NULL} if \code{plot = FALSE}). \cr
}
}
\description{
Estimates delay and embedding dimension (\code{m}) for each
variable time series using functions from \code{nonlinearTseries}.

The function is compatible with outputs from \code{\link[=resample_timeseries]{resample_timeseries()}} and
automatically accommodates participant-level subseries (\code{Series_ID}) when
available.
}
